# 統合ラマンスペクトル解析ツール

## 概要
ラマンスペクトルの解析に特化した統合解析ツールです。スペクトル解析、ピーク検出、多変量解析、AI解析の4つのモードを提供します。

## 機能

### 1. スペクトル解析モード
- 複数のラマンスペクトルファイルの読み込み
- ベースライン補正とスパイク除去
- スペクトルの可視化と比較
- 結果のCSVエクスポート

### 2. ラマンピーク解析モード
- 自動ピーク検出（2次微分法）
- インタラクティブなピーク編集
- 手動ピークの追加/除外
- グリッドサーチによる閾値最適化
- ピーク特性（FWHM、面積）の計算

### 3. 多変量解析モード
- NMF（非負値行列因子分解）による成分分析
- スコアプロットとローディングプロット
- 寄与率の可視化
- グループ別スペクトル解析

### 4. ピークAI解析モード
- RAG（Retrieval-Augmented Generation）による論文検索
- LLMを使用した化合物同定
- 解析結果に対する追加質問機能
- オンライン/オフライン対応

## インストール

### 基本機能のみ
```bash
pip install streamlit numpy pandas matplotlib seaborn scipy scikit-learn plotly
```

### 全機能（AI機能含む）
```bash
pip install -r requirements.txt
```

## 使用方法

### アプリケーションの起動
```bash
streamlit run main.py
```

### ファイル構成
```
project/
├── main.py                 # メインスクリプト
├── common_utils.py         # 共通ユーティリティ関数
├── spectrum_analysis.py    # スペクトル解析モジュール
├── peak_analysis.py        # ピーク解析モジュール
├── multivariate_analysis.py # 多変量解析モジュール
├── peak_ai_analysis.py     # AI解析モジュール
├── requirements.txt        # 必要パッケージ一覧
└── README.md              # このファイル
```

## 対応ファイル形式

### スペクトルデータ
- **RamanEye**: 新旧両形式対応
- **Wasatch ENLIGHTEN**: CSVエクスポート形式
- **Eagle**: 標準出力形式
- **汎用CSV/TXT**: カンマ/タブ区切り

### 文献データ（AI解析用）
- PDF
- DOCX
- TXT

## 使用上の注意

### AI機能について
- AI解析機能を使用する場合は、追加のライブラリが必要です
- OpenAI APIを使用する場合は、APIキーの設定が必要です
- オフライン使用時は、Ollamaのインストールと起動が必要です

### データ形式
- 波数は昇順である必要があります
- 強度値は数値型である必要があります
- ファイル名にグループ情報を含めると多変量解析で自動認識されます

## トラブルシューティング

### よくある問題

1. **ファイルが読み込めない**
   - ファイルのエンコーディングを確認（UTF-8またはShift-JIS）
   - ヘッダー行の形式を確認

2. **ピークが検出されない**
   - 閾値パラメータを調整
   - スペクトルの前処理（ベースライン補正）を確認

3. **AI解析が動作しない**
   - 必要なライブラリがインストールされているか確認
   - インターネット接続またはOllamaの起動状態を確認

## ライセンス
MIT License

## 作者
@hiroy

## 更新履歴
- 2025-06-11: Version 2.0.0 - モジュール分割版リリース
- 2025-06-11: Version 1.0.0 - 初版リリース